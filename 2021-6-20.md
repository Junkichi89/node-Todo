## ToDoアプリをExpressで作成しよう
　Chapter 11
https://zenn.dev/wkb/books/node-tutorial/viewer/todo_03


```
express --view=ejs todoapp
```

expressのテンプレートアプリの作成方法

作成した後、gitで管理したいので、todoappディレクトリの中身を取り出し、
todoappディレクトリを削除

不要なコードの整理

```
const indexRouter = require('./routes/index');
app.use('/', indexRouter);
```

indexRouterの定数は、他で特に使用されている気配がないので、一つにまとめる

```
app.use("/", require("./routes"));
```

app.jsを肥大化させないため、このように不要なコードをまびきしていきます

```
app.use('/', require('./routes'));
```
上記のコードについて、/に対するルーティングに対して、
./routes/indexで処理するように設定しています。

ちょっとわかりづらい？？？


Expressでは、const router = express.Router(); と router.get もしくは router.post でルーティングを行います。

module.exportsってそもそもなんだっけ？？


> routes/index.jsの6行目、res.render('index', { title: 'Express' });で分かるとおり、res.render()で行なっており、第一引数と合致する.ejsファイルに紐づいています。
また、第二引数には.ejsファイルに渡したい値をオブジェクトで渡します。

補足：viewsディレクトリ内のindex.ejsファイルを探すように設定されています。
ちょっとよくわからないけど、どうやってこれをejsファイルの指定をしているのか、他のファイルを指定することはできないのか、疑問
```
app.set('view engine', 'ejs');
```
おそらくこの辺で指定しているけど、使い方がよくわからんな〜〜


<%= %> と、その中に参照したい値のキーを記述することで参照ができる

views/index.ejs
```
 <h1><%= title %></h1>
 ```
 こんな感じで、第二引数に渡した、タイトルを使用することができる。

 ```
 npm install pug --save
```

pugを使用できるようにpugをインストール
app.jsにおいて、
```
app.set('view engine', 'ejs');
```
↓
```
app.set('view engine', 'pug');
```

に設定し、　viewsディレクトリのファイルの拡張子をpugに書き換えて実行すると読み込んでくれる。

pugに合わせた記述までは時間がかかりすぎるので、一旦スルー。

```
let todos = [];
/* GET home page. */
router.get('/', function (req, res, next) {
  res.render('index', {
    title: 'Todo App',
    todos: todos,
  });
});

router.post('/', function (req, res, next) {
  const todo = req.body.add;
  todos.push(todo);
  res.redirect('/')
});
```

このように書き換えることで、post内でレンダリングを行わないように設定します。
（レンダリングってなんだ？？？）

そして、redirectを使って、GETリクエストを送るように設定。
※res.redirect()は引数に指定したパスやURLに遷移させるメソッド

